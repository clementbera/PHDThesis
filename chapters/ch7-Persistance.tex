\ifx\wholebook\relax\else

% --------------------------------------------
% Lulu:

    \documentclass[a4paper,12pt,twoside]{../includes/ThesisStyle}

	\input{../includes/macros}
	\input{../includes/formatAndDefs}

	\graphicspath{{.}{../figures/}}
	\begin{document}
\fi

\chapter{Runtime state persistance across start-ups}
\label{chap:persistance}
\minitoc

This chapter describes how the Sista VM persists the runtime state across multiple VM start-ups, including the running green threads and the optimised code. The first section discusses how snapshots are implemented in Smalltalk, including how the code and the running green threads are persisted across start-ups. The second section focuses on the main issue: many VMs today have performance at start-up far worse than at peak performance. Several cases where the start-up performance is a problem are described. Section \ref{sec:persistanceSol} details our solution: optimised v-functions are persisted across multiple start-ups, allowing to persist optimised code and the running green threads. Section \ref{sec:relWork} compares our approach to existing VMs. Few VMs attempts to persist the runtime state across multiple start-ups, but some VMs include different solution to improve start-up performance, solving most of the problem.

\section{Snapshots and persistance}

- discuss snapshots again. 
and persist v-function, 
Explain briefly cogit mapping and v-function persistance.
Explain saving processes
platform independent
Restart from snapshot and move from v-function interpretation to n-func in loop and function call.

\section{Warm-up time problem}

- discuss warm-up time problem and why we talk mainly about this. (other people dont persist processes)

\section{Persistance of optimised virtual functions}
\label{sec:persistanceSol}

- Solution snapshot optimised v-functions - work the same way.
platform independent, moving from v-func interpretation to n-function.
Discussion on reg alloc and Cogit compilation time.

\section{Related work}
\label{sec:relWork}

- related work
from state of the art.

\paragraph{Conclusion.} This chapter discusses how the runtime state is persisted across multiple start-ups, improving the performance during start-up. The next chapter validates the Sista architecture, mainly through performance evaluation in a set of benchmarks. The validation chapter also evaluates the Sista VM performance when the runtime state is persisted across multiple start-ups.

\ifx\wholebook\relax\else
    \end{document}
\fi